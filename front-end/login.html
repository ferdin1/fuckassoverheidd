<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inloggen / Registreren - Rijksoverheid</title>
    <link rel="stylesheet" href="css/rijkshuisstijl.css">
</head>

<body>
    <header class="rijk-top-bar">
        <div class="rijk-header-top">
            <a href="dashboard.html" class="rijk-logo-link">
                <img src="https://www.rijkshuisstijl.nl/publiek/general/filestreamer.ashx?d=vePBKGSkhy7hArZX2fPnf67BDM1fdkK%2B22LcON6gT80KUVyGS%2Fw1GGkIgB2LbnNfAa77kkFAGIPKK5Ll7A0Vp1X8BPrR%2FBHYwrYEdKpPX0ADg1F7Pu5vAfJ6VS4Bfl%2FXypjYJVLFt5eALy3vNueZGI5YAjdAF%2FSyy9cCYK4Ck91pjXT7KzerH3%2BkJpLxkmZ%2F6OPSkTN4WqfVbx68D1eFTOb7kil7Ka9AjS0J%2BPcL19DojCVnYR4PgeS6J2BGk%2FLaa7j%2B88BAel7x1W4jbKD5KEf%2Bu6TQdVuSMWuinTiOW7cPgSGSfmipO2Dq3VnXYBHm1nWBtPDHn3YlpZWu7fSFD4bd5t%2B2jMIUN81yTvThr%2BQ%3D"
                    alt="Rijksoverheid Logo" class="rijk-logo">
                <span class="rijk-org-name">Rijksoverheid Loopbaan</span>
                <span class="rijk-ministry">Ministerie van Justitie en Veiligheid</span>
            </a>
        </div>
        <div class="rijk-header-nav">
            <nav class="rijk-main-nav">
                <a href="dashboard.html" class="rijk-nav-link">Home</a>
                <a href="kaart.html" class="rijk-nav-link">Kaart</a>
                <a href="functies.html" class="rijk-nav-link">Functies</a>
                <button class="rijk-nav-link">Menu</button>
            </nav>
            <div class="rijk-search-container">
                <input type="search" class="rijk-search-input" placeholder="Waar bent u naar op zoek?">
                <button class="rijk-search-btn">üîç</button>
            </div>
            <div>
                <a href="dashboard.html" class="rijk-login-btn">‚Üê Terug</a>
            </div>
        </div>
    </header>

    <div class="rijk-login-container">
        <div class="rijk-login-card" id="formContainer">
            <h2 id="formTitle">Inloggen</h2>
            <p id="formSubtitle" class="rijk-card-text">Toegang voor medewerkers van het CJIB</p>

            <form id="authForm">
                <div class="rijk-form-group">
                    <label class="rijk-label">Gebruikersnaam</label>
                    <input type="text" id="username" class="rijk-input" placeholder="Gebruikersnaam" required>
                </div>
                <div class="rijk-form-group">
                    <label class="rijk-label">Wachtwoord</label>
                    <input type="password" id="password" class="rijk-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button type="submit" class="rijk-btn" id="submitBtn">Inloggen</button>
                <div id="statusMsg" class="rijk-message" style="display: none;"></div>
            </form>

            <a class="rijk-nav-link text-center mt-lg" id="toggleLink">Nog geen account? Registreer hier</a>
            <br>
            <a href="dashboard.html" class="rijk-nav-link text-center mt-sm">‚Üê Terug naar dashboard</a>
        </div>
    </div>

    <script src="../back-end/javascript/auth.js"></script>
    <script>
        let isLogin = true;
        const formTitle = document.getElementById('formTitle');
        const formSubtitle = document.getElementById('formSubtitle');
        const submitBtn = document.getElementById('submitBtn');
        const toggleLink = document.getElementById('toggleLink');
        const statusMsg = document.getElementById('statusMsg');

        toggleLink.onclick = () => {
            isLogin = !isLogin;
            statusMsg.style.display = 'none';
            if (isLogin) {
                formTitle.textContent = "Inloggen";
                formSubtitle.textContent = "Toegang voor medewerkers van het CJIB";
                submitBtn.textContent = "Inloggen";
                toggleLink.textContent = "Nog geen account? Registreer hier";
            } else {
                formTitle.textContent = "Registreren";
                formSubtitle.textContent = "Maak een nieuw account aan voor het CJIB";
                submitBtn.textContent = "Account Aanmaken";
                toggleLink.textContent = "Al een account? Log hier in";
            }
        };

        document.getElementById('authForm').onsubmit = async (e) => {
            e.preventDefault();
            const user = document.getElementById('username').value;
            const pass = document.getElementById('password').value;

            statusMsg.style.display = 'none';

            if (typeof Auth !== 'undefined') {
                if (isLogin) {
                    const result = await Auth.login(user, pass);
                    if (result.success) {
                        window.location.href = 'dashboard.html';
                    } else {
                        statusMsg.textContent = result.message || "Inloggen mislukt";
                        statusMsg.className = "rijk-message rijk-message-error";
                        statusMsg.style.display = 'block';
                    }
                } else {
                    const result = await Auth.register(user, pass);
                    if (result.success) {
                        statusMsg.textContent = "Registratie gelukt! Je kunt nu inloggen.";
                        statusMsg.className = "rijk-message rijk-message-success";
                        statusMsg.style.display = 'block';
                        setTimeout(() => toggleLink.click(), 2000);
                    } else {
                        statusMsg.textContent = result.message || "Registratie mislukt";
                        statusMsg.className = "rijk-message rijk-message-error";
                        statusMsg.style.display = 'block';
                    }
                }
            }
        };
    </script>
</body>

</html>